{
  "apiUrl": "",
  "actUserId": 1,
  "objectColors": {
    "country": "#c08",
    "fqdn": "#c00",
    "hash": "#0a8",
    "incident": "#06b",
    "ipv4": "#00c",
    "location": "#d2d",
    "report": "#0a0",
    "technique": "#d04",
    "threatActor": "#606",
    "tool": "#b60",
    "uri": "#0c0"
  },
  "autoResolveFacts": {
    "asn": ["name"],
    "ipv4": ["sinkhole"],
    "ipv6": ["sinkhole"],
    "path": ["basename"],
    "report": ["name"],
    "uri": ["port", "scheme"]
  },
  "predefinedObjectQueries": [
    {
      "name": "related",
      "description": "Related reports",
      "query": "g.as('startNode').outE('mentions').otherV().hasLabel(within('ipv4','hash','email','uri')).where(inE('mentions').count().is(lt(20L))).inE('mentions').otherV().hasLabel('report').where(neq('startNode')).path().unfold()",
      "objects": ["report"]
    },
    {
      "name": "context",
      "description": "Report context",
      "query": "g.outE('mentions').otherV().choose(label()).option('hash',outE('represents').otherV().optional(bothE().otherV())).option('ipv4',union(outE('componentOf').otherV(),where(inE('resolvesTo').count().is(lte(50L))).inE('resolvesTo').otherV(),repeat(outE('memberOf').otherV()).times(2).optional(inE('owns').otherV().outE().hasLabel(without('owns')).otherV()))).option('fqdn',where(outE('resolvesTo').count().is(lte(50L))).outE('resolvesTo').otherV()).option('threatActor',emit().repeat(outE('alias').outV()).until(cyclicPath())).option('tool',emit().repeat(outE('alias').outV()).until(cyclicPath())).path().unfold()",
      "objects": ["report"]
    },
    {
      "name": "mentions",
      "description": "Mentioned in report",
      "query": "g.inE('mentions').otherV().hasLabel('report').path().unfold()",
      "objects": [
        "campaign",
        "certificate",
        "email",
        "fqdn",
        "hash",
        "ipv4",
        "ipv6",
        "country",
        "region",
        "subRegion",
        "mutex",
        "organization",
        "person",
        "sector",
        "threatActor",
        "uri",
        "userAgent",
        "vulnerability"
      ]
    },
    {
      "name": "reports",
      "description": "Find reports that mention IP addresses from this autonomous system.",
      "query": "g.repeat(inE('memberOf').otherV()).times(2).inE('mentions').otherV().path().unfold()",
      "objects": ["asn"]
    },
    {
      "name": "reports",
      "description": "Find reports that mention either the name of this tool or hashes classified as this tool.",
      "query": "g.union(inE('mentions').otherV(),inE('classifiedAs').otherV().inE('represents').otherV().inE('mentions').otherV()).path().unfold()",
      "objects": ["tool"]
    },
    {
      "name": "tools",
      "description": "Tools used by this threat actor",
      "query": "g.union(repeat(inE('alias').otherV()).until(cyclicPath()).inE('attributedTo').otherV().inE('observedIn').otherV().outE('classifiedAs').otherV(),inE('attributedTo').otherV().inE('observedIn').otherV().outE('classifiedAs').otherV()).repeat(inE('alias').otherV()).until(cyclicPath()).path().unfold()",
      "objects": ["threatActor"]
    },
    {
      "name": "techniques",
      "description": "Techniques used by this threat actor",
      "query": "g.union(repeat(inE('alias').otherV()).until(cyclicPath()).inE('attributedTo').otherV().inE('observedIn').otherV().hasLabel('technique'),inE('attributedTo').otherV().inE('observedIn').otherV().hasLabel('technique')).path().unfold()",
      "objects": ["threatActor"]
    }
  ]
}
